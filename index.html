<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mo64 Profile | Online</title>
    
    <meta property="og:title" content="Ù…Ø´Ø¹Ù„ Ø³Ø¹ÙŠØ¯ - Mashal Said">
    <meta property="og:description" content="Ù…ÙˆÙ‚Ø¹ÙŠ Ø§Ù„Ø´Ø®ØµÙŠ Ø¨Ø¥Ø³Ù„ÙˆØ¨ÙŠ Ø§Ù„Ø®Ø§Øµ">
    <meta property="og:image" content="https://raw.githubusercontent.com/mashalsaid/Myweb/main/profile.jpg">
    <meta property="og:url" content="https://mashalsaid.github.io/Myweb/">
    <meta property="og:type" content="website">

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&family=Rubik:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'brand-yellow': '#FFDE00',
                        'brand-pink': '#FF90E8',
                        'brand-blue': '#22CCFF',
                        'brand-purple': '#9D4EDD',
                    },
                    boxShadow: {
                        'hard': '4px 4px 0px 0px #000',
                        'hard-hover': '2px 2px 0px 0px #000',
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #fff;
            background-image: linear-gradient(#f0f0f0 1px, transparent 1px), linear-gradient(90deg, #f0f0f0 1px, transparent 1px);
            background-size: 20px 20px;
            font-family: 'Cairo', sans-serif;
            overflow-x: hidden;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }
        .marquee-wrapper { display: flex; overflow: hidden; gap: 0; }
        .marquee-content { flex-shrink: 0; display: flex; align-items: center; justify-content: space-around; min-width: 100%; animation: scroll 20s linear infinite; }
        @keyframes scroll { from { transform: translateX(0); } to { transform: translateX(-100%); } }
        
        .pixel-svg { width: 100%; height: 100%; display: block; shape-rendering: crispEdges; }
        .avatar-container { border: 4px solid transparent; transition: all 0.2s; background-color: #f3f4f6; cursor: pointer; width: 100%; aspect-ratio: 1/1; max-width: 80px; margin: 0 auto; }
        .avatar-option input:checked + .avatar-container { border-color: #000; transform: scale(1.1); box-shadow: 4px 4px 0px #000; z-index: 10; background-color: #fff; }
        
        /* Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªØ­ÙƒÙ… Ù„Ù„Ø£Ø¯Ù…Ù† (Ù…Ø®ÙÙŠØ© Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹) */
        .comment-admin-btns { display: none; }
        .msg-delete-btn { display: none; }

        /* Ø¥Ø¸Ù‡Ø§Ø± Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªØ­ÙƒÙ… Ø¹Ù†Ø¯ ØªÙØ¹ÙŠÙ„ Ø§Ù„ÙƒÙ„Ø§Ø³ */
        body.admin-active .comment-admin-btns { 
            display: flex; 
            flex-direction: column;
            gap: 5px;
            position: absolute;
            left: 5px;
            top: 5px;
            z-index: 20;
        }
        
        /* Ø²Ø± Ø­Ø°Ù Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø´Ø§Øª */
        body.admin-active .msg-delete-btn { 
            display: flex; 
            position: absolute; 
            top: -8px; 
            left: -8px; 
            background: #ff0000; 
            color: white; 
            border: 2px solid black; 
            width: 18px; 
            height: 18px; 
            border-radius: 50%; 
            font-size: 10px; 
            align-items: center; 
            justify-content: center;
            cursor: pointer;
            z-index: 10;
            font-weight: bold;
        }
        
        @keyframes swing { 0% { transform: rotate(var(--r)); } 50% { transform: rotate(calc(var(--r) + 2deg)); } 100% { transform: rotate(var(--r)); } }
        .hanging-photo:hover { animation: swing 1s ease-in-out infinite; }
        
        .hype-anim { animation: bounce-crazy 0.5s ease-in-out; }
        @keyframes bounce-crazy { 0%, 100% { transform: scale(1); } 50% { transform: scale(0.9); } 100% { transform: scale(1); } }
        .floating-fab { animation: float-btn 3s ease-in-out infinite; }
        @keyframes float-btn { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        #commentsList::-webkit-scrollbar, #chatMessages::-webkit-scrollbar { width: 6px; }
        #commentsList::-webkit-scrollbar-thumb, #chatMessages::-webkit-scrollbar-thumb { background: #000; border-radius: 4px; }

        /* Ø§Ù„Ø´Ø§Øª */
        #chatFab { position: fixed; bottom: 100px; right: 20px; z-index: 50; touch-action: none; transition: transform 0.1s; }
        .chat-bubble { border: 3px solid #000; color: #000; padding: 8px 12px; font-weight: bold; position: relative; }
        .chat-bubble-me { background-color: #22CCFF; border-radius: 15px 15px 0 15px; margin-left: auto; }
        .chat-bubble-other { border-radius: 15px 15px 15px 0; margin-right: auto; }

        /* Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù† */
        .admin-box { @apply border-4 border-black bg-gray-100 p-4 mb-4 shadow-hard rounded-lg; }
        .admin-input { @apply w-full bg-white border-2 border-black text-black p-2 mb-2 font-bold outline-none focus:bg-yellow-100 rounded text-lg; }
        .admin-label { @apply text-black font-black block mb-2 text-lg border-b-4 border-brand-yellow pb-1 inline-block; }

        .heart-svg-btn { transition: transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275); cursor: pointer; filter: drop-shadow(2px 2px 0px rgba(0,0,0,0.5)); }
        .heart-svg-btn:active { transform: scale(0.8); }
        .like-bounce { animation: like-bounce 0.4s; }
        @keyframes like-bounce { 0% { transform: scale(1); } 50% { transform: scale(1.4) rotate(-10deg); } 100% { transform: scale(1); } }
    </style>
</head>
<body class="flex flex-col min-h-screen text-black">

    <audio id="clickSound" src="https://assets.mixkit.co/active_storage/sfx/2571/2571-preview.mp3"></audio>
    <audio id="popSound" src="https://assets.mixkit.co/active_storage/sfx/2568/2568-preview.mp3"></audio>
    <audio id="msgSound" src="https://assets.mixkit.co/active_storage/sfx/2354/2354-preview.mp3"></audio>

    <main class="flex-grow flex flex-col items-center justify-center pt-10 pb-6 relative z-10 w-full overflow-hidden">
        
        <div class="text-center mb-8 w-full max-w-2xl px-6">
            <div class="relative w-40 h-40 mx-auto mb-6 group">
                <div class="absolute inset-0 bg-brand-blue rounded-full border-4 border-black translate-x-2 translate-y-2 transition-transform group-hover:translate-x-1 group-hover:translate-y-1"></div>
                <img src="https://raw.githubusercontent.com/mashalsaid/Myweb/main/profile.jpg" onerror="this.src='https://api.dicebear.com/9.x/pixel-art/svg?seed=Mo64'" alt="Profile" class="relative w-full h-full object-cover rounded-full border-4 border-black bg-white">
                <div class="absolute bottom-0 right-0 bg-green-400 w-8 h-8 rounded-full border-4 border-black animate-pulse"></div>
            </div>
            <h1 id="adminTriggerBtn" class="text-5xl font-black mb-2 cursor-pointer hover:text-brand-blue transition-colors select-none">Ù…ÙØ´Ù’Ø¹ÙÙ„</h1>
            <p class="text-xl font-bold text-gray-600 bg-white border-2 border-black inline-block px-4 py-1 shadow-hard -rotate-1">Ù…Ø·ÙˆØ± ÙˆÙŠØ¨ & Ù…ØµÙ…Ù… ÙˆÙ…Ø­Ø§Ø³Ø¨ ÙƒÙ…Ø§Ù† ğŸ˜‚</p>
            <div class="mt-8 relative z-0">
                <div class="absolute inset-0 bg-brand-yellow transform rotate-1 border-4 border-black shadow-hard translate-y-2 rounded-xl -z-10"></div>
                <div class="bg-white border-4 border-black p-6 rounded-xl shadow-sm text-lg font-bold leading-relaxed text-gray-800">
                    Ø£Ù‡Ù„Ø§Ù‹! Ø£Ù†Ø§ Ù…Ø´Ø¹Ù„ (Ù…ÙˆØ§Ù„ÙŠØ¯ Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„ØºØ±ÙŠØ¨ 2002) Ø¨Ø­Ø§ÙˆÙ„ Ø£Ø­Ù‚Ù‚ ÙƒÙ„ Ø£ÙÙƒØ§Ø±ÙŠ Ø§Ù„Ù‰ ÙˆØ§Ù‚Ø¹ Ø±Ù‚Ù…ÙŠ ÙˆØ±Ø¨Ù†Ø§ ÙŠØ³ØªØ± Ù…Ù† Ø¯Ù…Ø§ØºÙŠ.
                </div>
            </div>
        </div>

        <div class="w-full mb-10 py-4 overflow-hidden">
            <div class="bg-brand-pink border-y-4 border-black py-3 shadow-hard rotate-1 scale-105 marquee-wrapper" dir="ltr">
                <div class="marquee-content font-black text-xl text-white drop-shadow-[2px_2px_0_rgba(0,0,0,1)]">
                    <span class="mx-6">â˜• Ø§Ù†Ø§ Ø¨Ø´Ø±Ø¨ Ù‚Ù‡ÙˆØ© ÙˆØ¨Ù†Ø§Ù… Ø¨Ø¹Ø¯Ù‡Ø§ Ø¹Ø§Ø¯ÙŠ</span><span class="mx-6">ğŸ˜ Ø´Ø§ÙŠÙÙ†ÙŠ Ø·ÙŠØ¨ØŸ</span><span class="mx-6">ğŸ¤– AI Ø¨Ø¹Ø´Ù‚ ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ </span><span class="mx-6">ğŸš€ Ø£ÙÙƒØ§Ø±ÙŠ Ø®Ø§Ø±Ø¬ Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚</span>
                </div>
                <div class="marquee-content font-black text-xl text-white drop-shadow-[2px_2px_0_rgba(0,0,0,1)]">
                    <span class="mx-6">â˜• Ø§Ù†Ø§ Ø¨Ø´Ø±Ø¨ Ù‚Ù‡ÙˆØ© ÙˆØ¨Ù†Ø§Ù… Ø¨Ø¹Ø¯Ù‡Ø§ Ø¹Ø§Ø¯ÙŠ</span><span class="mx-6">ğŸ˜ Ø´Ø§ÙŠÙÙ†ÙŠ Ø·ÙŠØ¨ØŸ</span><span class="mx-6">ğŸ¤– AI Ø¨Ø¹Ø´Ù‚ ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ </span><span class="mx-6">ğŸš€ Ø£ÙÙƒØ§Ø±ÙŠ Ø®Ø§Ø±Ø¬ Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚</span>
                </div>
            </div>
        </div>

        <div class="w-full max-w-5xl px-6 mb-24 mt-12 relative z-10 mx-auto">
            <div class="relative w-full">
                <div class="absolute -top-16 left-1/2 -translate-x-1/2 bg-black text-white px-6 py-2 border-4 border-white font-black -rotate-1 shadow-hard z-20 text-xl transform hover:scale-110 transition-transform select-none">
                    Ø°ÙƒØ±ÙŠØ§Øª Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© ğŸ“¸
                </div>
                <svg class="absolute -top-4 left-0 w-full h-16 pointer-events-none z-0 hidden sm:block" viewBox="0 0 100 20" preserveAspectRatio="none">
                    <path d="M0,0 Q50,20 100,0" fill="none" stroke="black" stroke-width="0.5" />
                </svg>
                <div class="flex flex-wrap justify-center gap-6 pt-6">
                    <div class="hanging-photo relative group cursor-pointer" style="--r: 2deg;">
                        <div class="absolute -top-10 left-1/2 -translate-x-1/2 w-1 h-12 bg-black z-0"></div>
                        <div class="absolute -top-10 left-1/2 -translate-x-1/2 w-3 h-3 bg-black rounded-full z-10"></div>
                        <div class="bg-white p-2 pb-6 border-4 border-black shadow-hard rotate-2 transition-transform duration-300 w-40 relative z-10">
                            <div class="absolute -top-3 left-1/2 -translate-x-1/2 w-8 h-3 bg-yellow-200/60 border-l border-r border-black/20 rotate-1"></div> 
                            <div class="w-full h-32 bg-gray-100 border-2 border-black overflow-hidden mb-2 relative">
                                <img src="photo1.jpg" onerror="this.src='https://placehold.co/600x400/FFDE00/000?text=Image+1'" class="w-full h-full object-cover grayscale group-hover:grayscale-0 transition-all duration-500">
                            </div>
                            <p class="text-center font-bold text-sm text-gray-700 font-serif">Ø§Ù„Ù‚Ø·Ø© Ø§Ù„Ù…Ø´Ù…Ø´ÙŠØ©</p>
                        </div>
                    </div>
                    <div class="hanging-photo relative group cursor-pointer mt-4 sm:mt-0" style="--r: -1deg;">
                        <div class="absolute -top-12 left-1/2 -translate-x-1/2 w-1 h-16 bg-black z-0"></div>
                        <div class="absolute -top-12 left-1/2 -translate-x-1/2 w-3 h-3 bg-black rounded-full z-10"></div>
                        <div class="bg-white p-2 pb-6 border-4 border-black shadow-hard -rotate-1 transition-transform duration-300 w-40 relative z-10 translate-y-2">
                             <div class="absolute -top-3 left-1/2 -translate-x-1/2 w-8 h-3 bg-pink-200/60 border-l border-r border-black/20 -rotate-2"></div>
                            <div class="w-full h-32 bg-gray-100 border-2 border-black overflow-hidden mb-2">
                                <img src="photo2.jpg" onerror="this.src='https://placehold.co/600x400/FF90E8/000?text=Image+2'" class="w-full h-full object-cover grayscale group-hover:grayscale-0 transition-all duration-500">
                            </div>
                            <p class="text-center font-bold text-sm text-gray-700 font-serif">Ø¥ÙŠÙÙ†Øª Ø§Ù„Ø³Ù†Ø© ğŸ‰</p>
                        </div>
                    </div>
                    <div class="hanging-photo relative group cursor-pointer" style="--r: 1deg;">
                        <div class="absolute -top-10 left-1/2 -translate-x-1/2 w-1 h-12 bg-black z-0"></div>
                        <div class="absolute -top-10 left-1/2 -translate-x-1/2 w-3 h-3 bg-black rounded-full z-10"></div>
                        <div class="bg-white p-2 pb-6 border-4 border-black shadow-hard rotate-1 transition-transform duration-300 w-40 relative z-10">
                            <div class="absolute -top-3 left-1/2 -translate-x-1/2 w-8 h-3 bg-blue-200/60 border-l border-r border-black/20 rotate-0"></div>
                            <div class="w-full h-32 bg-gray-100 border-2 border-black overflow-hidden mb-2">
                                <img src="photo3.jpg" onerror="this.src='https://placehold.co/600x400/22CCFF/000?text=Image+3'" class="w-full h-full object-cover grayscale group-hover:grayscale-0 transition-all duration-500">
                            </div>
                            <p class="text-center font-bold text-sm text-gray-700 font-serif">Ù…ÙƒØ§Ù† Ø´ØºÙ„ÙŠ ğŸ’»</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="w-full max-w-2xl px-6 mb-12">
            <div class="bg-white border-4 border-black p-8 shadow-hard relative mt-4">
                <div class="absolute -top-6 left-1/2 -translate-x-1/2 bg-brand-blue px-8 py-2 border-4 border-black font-black -rotate-1 text-black text-xl shadow-sm">Ø£Ù‚Ø³Ø§Ù…ÙŠ ğŸ“‚</div>
                <div class="flex flex-col gap-4 mt-4">
                    <button onclick="showWorkInProgress('websites')" class="btn-action bg-brand-blue border-4 border-black p-4 text-center font-black text-xl shadow-[4px_4px_0px_#000] hover:translate-x-[2px] hover:translate-y-[2px] transition-all flex items-center justify-center gap-3 w-full"><span>Ù…ÙˆØ§Ù‚Ø¹ÙŠ</span></button>
                    <button onclick="showWorkInProgress('designs')" class="btn-action bg-brand-pink border-4 border-black p-4 text-center font-black text-xl shadow-[4px_4px_0px_#000] hover:translate-x-[2px] hover:translate-y-[2px] transition-all flex items-center justify-center gap-3 w-full"><span>ØªØµØ§Ù…ÙŠÙ…ÙŠ</span></button>
                    <button onclick="openContactModal()" class="btn-action bg-green-400 border-4 border-black p-4 text-center font-black text-xl shadow-[4px_4px_0px_#000] hover:translate-x-[2px] hover:translate-y-[2px] transition-all flex items-center justify-center gap-3 text-black w-full"><i class="fa-solid fa-comments text-2xl"></i><span>ÙƒÙ„Ù…Ù†ÙŠ</span></button>
                </div>
            </div>
        </div>

        <div class="w-full max-w-2xl px-6 mb-12">
            <div class="bg-white border-4 border-black p-6 shadow-hard relative mt-4">
                <div id="guestbookTitle" class="absolute -top-5 left-1/2 -translate-x-1/2 bg-brand-yellow px-4 py-1 border-4 border-black font-black rotate-1 text-black cursor-pointer hover:scale-105 transition-transform select-none">
                    Ø³Ø§Ø­Ø© Ø§Ù„Ø²ÙˆØ§Ø± ğŸ’¬
                </div>
                
                <div id="commentsList" class="space-y-4 mt-6 max-h-80 overflow-y-auto p-2">
                    <div class="text-center text-gray-500 font-bold loading-msg">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª... â³</div>
                </div>

                <button onclick="openCommentModal()" class="btn-action w-full mt-6 bg-black text-white border-4 border-black p-3 font-black shadow-hard hover:shadow-hard-hover hover:translate-y-1 transition-all flex items-center justify-center gap-2">
                    <i class="fa-solid fa-pen-nib"></i> Ø£Ø¶Ù ØªØ¹Ù„ÙŠÙ‚Ùƒ
                </button>
            </div>
        </div>
    </main>

    <div class="fixed bottom-6 right-6 z-50 floating-fab group">
        <div id="hypeCount" class="absolute -top-3 -left-3 bg-red-500 text-white font-black border-2 border-black px-2 py-1 rounded-full text-sm z-20 shadow-hard-hover">0</div>
        <button id="hypeBtn" class="bg-brand-yellow w-20 h-20 rounded-full border-4 border-black shadow-hard group-hover:scale-110 transition-all flex items-center justify-center text-4xl active:bg-white">ğŸ”¥</button>
    </div>

    <div id="chatFab" class="hidden cursor-move hover:scale-110 transition-transform">
        <button onclick="toggleGlobalChat()" class="bg-brand-purple w-16 h-16 rounded-full border-4 border-black shadow-hard flex items-center justify-center text-3xl text-white"><i class="fa-solid fa-comments"></i></button>
    </div>

    <div id="globalChatModal" class="fixed inset-0 bg-black/50 z-[250] hidden flex items-end sm:items-center justify-center pointer-events-none">
        <div class="bg-white w-full sm:w-96 h-[500px] border-t-4 sm:border-4 border-black shadow-hard flex flex-col pointer-events-auto transition-transform transform translate-y-full sm:translate-y-0 duration-300" id="chatContainer">
            <div class="bg-brand-purple border-b-4 border-black p-3 flex justify-between items-center cursor-pointer" onclick="toggleGlobalChat()">
                <h3 class="font-black text-white text-lg">ğŸ’¬ Ø´Ø§Øª Ø§Ù„Ø²ÙˆØ§Ø± Ø§Ù„Ø¹Ø§Ù…</h3>
                <button class="text-white font-bold bg-black px-2 border-2 border-white">X</button>
            </div>
            <div id="chatMessages" class="flex-1 overflow-y-auto p-4 space-y-3 bg-gray-100"></div>
            <div class="p-3 border-t-4 border-black bg-white flex gap-2">
                <input type="text" id="globalChatInput" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø©..." class="flex-1 border-4 border-black p-2 font-bold outline-none">
                <button onclick="sendGlobalMessage()" class="bg-brand-yellow border-4 border-black p-2 px-4 font-black hover:bg-yellow-400"><i class="fa-solid fa-paper-plane"></i></button>
            </div>
        </div>
    </div>

    <div id="adminModal" class="fixed inset-0 bg-black z-[200] hidden flex items-center justify-center p-4">
        <div class="text-center w-full max-w-sm">
            <h2 class="text-brand-yellow text-4xl font-black mb-6 animate-pulse">ğŸ”’ Ù…Ù†Ø·Ù‚Ø© Ù…Ø­Ø¸ÙˆØ±Ø©</h2>
            <div id="adminLogin">
                <input type="password" id="adminPass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±..." class="w-full bg-black border-4 border-white text-white p-4 text-center text-xl font-bold outline-none mb-4">
                <button onclick="checkAdmin()" class="bg-white text-black border-4 border-gray-500 w-full p-4 font-black text-xl hover:bg-brand-pink transition-colors">Ø¯Ø®ÙˆÙ„</button>
                <button onclick="closeAdmin()" class="text-gray-500 mt-4 text-sm hover:text-white">Ø¥Ù„ØºØ§Ø¡</button>
            </div>
            <div id="adminPanel" class="hidden w-full max-h-[80vh] overflow-y-auto">
                <div class="bg-white p-4 border-4 border-black mb-4 rounded text-right shadow-hard">
                    <h3 class="text-black font-black mb-4 text-center text-xl border-b-4 border-black pb-2">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹</h3>
                    
                    <div class="admin-box">
                        <label class="admin-label">ğŸ‘‹ Ø§Ù„ØªØ±Ø­ÙŠØ¨</label>
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-black text-sm font-bold">Ø§Ù„Ø­Ø§Ù„Ø©:</span>
                            <button id="toggleWelcomeBtn" onclick="toggleSetting('welcome')" class="text-xs px-2 py-1 bg-gray-500 text-white" data-state="true">ØªØ­Ù…ÙŠÙ„...</button>
                        </div>
                        <textarea id="welcomeText1" class="admin-input h-16" placeholder="Ù†Øµ Ø§Ù„Ø²ÙŠØ§Ø±Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰"></textarea>
                        <textarea id="welcomeText2" class="admin-input h-16" placeholder="Ù†Øµ Ø§Ù„Ø²ÙŠØ§Ø±Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©"></textarea>
                        <button onclick="saveWelcomeTexts()" class="bg-green-600 text-white border-2 border-black w-full py-2 font-bold hover:bg-green-500 shadow-[2px_2px_0px_#000]">Ø­ÙØ¸ Ø§Ù„Ù†ØµÙˆØµ</button>
                    </div>

                    <div class="admin-box">
                        <label class="admin-label">ğŸ’¬ Ø§Ù„Ø´Ø§Øª Ø§Ù„Ø¹Ø§Ù…</label>
                        <div class="flex justify-between items-center">
                            <span class="text-black text-sm font-bold">ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø´Ø§Øª:</span>
                            <button id="toggleChatBtn" onclick="toggleSetting('chat')" class="text-xs px-2 py-1 bg-gray-500 text-white" data-state="true">ØªØ­Ù…ÙŠÙ„...</button>
                        </div>
                        <div class="mt-4 border-t-2 border-gray-300 pt-2">
                            <button onclick="deleteAllChat()" class="bg-red-600 text-white border-2 border-black w-full py-2 font-bold hover:bg-red-500 shadow-[2px_2px_0px_#000]">ğŸ—‘ï¸ Ø­Ø°Ù ÙƒÙ„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„</button>
                        </div>
                    </div>

                    <div class="admin-box">
                        <label class="admin-label">ğŸ“¢ Ø±Ø³Ø§Ù„Ø© Ù„Ù„Ø¬Ù…ÙŠØ¹</label>
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-black text-sm font-bold">ØªÙØ¹ÙŠÙ„:</span>
                            <button id="togglePopupBtn" onclick="toggleSetting('popup')" class="text-xs px-2 py-1 bg-gray-500 text-white" data-state="true">ØªØ­Ù…ÙŠÙ„...</button>
                        </div>
                        <textarea id="popupText" class="admin-input h-20" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù‡Ù†Ø§..."></textarea>
                        <div class="flex items-center gap-2 mb-2">
                            <span class="text-black text-xs font-bold">Ø¨Ø¹Ø¯ ÙƒØ§Ù… Ø«Ø§Ù†ÙŠØ©:</span>
                            <input id="popupDelay" type="number" class="admin-input w-20 text-center" value="3">
                        </div>
                        <button onclick="savePopupSettings()" class="bg-brand-yellow text-black border-2 border-black font-bold w-full py-2 hover:bg-yellow-400 shadow-[2px_2px_0px_#000]">Ù†Ø´Ø± Ø§Ù„Ø±Ø³Ø§Ù„Ø©</button>
                    </div>

                </div>
                
                <div class="flex gap-2">
                    <button onclick="hideAdminPanel()" class="flex-1 bg-gray-500 text-white border-4 border-black px-4 py-2 hover:bg-gray-400 font-black shadow-hard">â– Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù„ÙˆØ­Ø©</button>
                    <button onclick="logoutAdmin()" class="flex-1 bg-red-600 text-white border-4 border-black px-4 py-2 hover:bg-red-500 font-black shadow-hard">ğŸ”’ ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>
                </div>
            </div>
        </div>
    </div>

    <div id="infoModal" class="fixed inset-0 bg-black/80 z-[300] hidden flex items-center justify-center p-6 backdrop-blur-sm">
        <div class="bg-white border-4 border-black shadow-hard p-8 w-full max-w-md text-center relative">
            <h2 id="infoTitle" class="text-3xl font-black mb-4"></h2>
            <p id="infoBody" class="text-lg font-bold text-gray-700 mb-8 leading-relaxed"></p>
            <button onclick="closeInfo()" class="w-full bg-black text-white border-4 border-black p-4 font-black text-xl hover:bg-brand-blue hover:text-black">ØªÙ…Ø§Ù… ğŸ˜‚</button>
        </div>
    </div>

    <div id="welcomeModal" class="fixed inset-0 bg-black/80 z-[300] hidden flex items-center justify-center p-6 backdrop-blur-sm">
        <div class="bg-white border-4 border-black shadow-hard p-8 w-full max-w-md text-center relative">
            <h2 id="welcomeTitle" class="text-3xl font-black mb-4"></h2>
            <p id="welcomeBody" class="text-lg font-bold text-gray-700 mb-8 leading-relaxed"></p>
            <button onclick="closeWelcome()" class="w-full bg-black text-white border-4 border-black p-4 font-black text-xl hover:bg-brand-blue hover:text-black">Ø§Ø´Ø·Ø§ØŒ ÙÙ‡Ù…Øª! ğŸš€</button>
        </div>
    </div>

    <div id="globalMessageModal" class="fixed inset-0 bg-black/90 z-[400] hidden flex items-center justify-center p-6 backdrop-blur-sm">
        <div class="bg-brand-yellow border-4 border-black shadow-hard p-8 w-full max-w-md text-center relative rotate-1">
            <div class="absolute -top-6 left-1/2 -translate-x-1/2 bg-black text-white px-4 py-1 font-bold border-2 border-white">ğŸ“¢ Ø±Ø³Ø§Ù„Ø© Ù…Ù† Ù…Ø´Ø¹Ù„</div>
            <p id="globalMessageBody" class="text-2xl font-black text-black mb-8 leading-relaxed mt-4"></p>
            <button onclick="document.getElementById('globalMessageModal').classList.add('hidden')" class="w-full bg-white text-black border-4 border-black p-3 font-black text-xl hover:bg-gray-100">ØªÙ… Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù… ğŸ«¡</button>
        </div>
    </div>

    <div id="contactModal" class="fixed inset-0 bg-black/80 z-[200] hidden flex items-center justify-center p-4 backdrop-blur-sm">
        <div class="bg-white border-4 border-black shadow-hard p-6 w-full max-w-sm relative">
            <button onclick="closeContactModal()" class="absolute -top-4 -right-4 bg-red-500 text-white w-10 h-10 border-4 border-black font-black hover:scale-110">X</button>
            <h2 class="text-2xl font-black text-center mb-6 bg-brand-blue border-2 border-black inline-block px-4 mx-auto rotate-1">ØªÙˆØ§ØµÙ„ Ù…Ø¹ÙŠ ğŸ“</h2>
            <div class="flex flex-col gap-3">
                <a href="https://wa.me/201551179695" target="_blank" class="flex items-center gap-4 bg-[#25D366] border-4 border-black p-3 font-black text-white hover:translate-x-1 hover:translate-y-1 hover:shadow-none shadow-[4px_4px_0px_#000] transition-all"><i class="fa-brands fa-whatsapp text-3xl"></i> <span class="text-xl">WhatsApp</span></a>
                <a href="https://Instagram.com/misho_64" target="_blank" class="flex items-center gap-4 bg-gradient-to-r from-purple-500 to-pink-500 border-4 border-black p-3 font-black text-white hover:translate-x-1 hover:translate-y-1 hover:shadow-none shadow-[4px_4px_0px_#000] transition-all"><i class="fa-brands fa-instagram text-3xl"></i> <span class="text-xl">Instagram</span></a>
                <a href="https://www.snapchat.com/add/misho_64" target="_blank" class="flex items-center gap-4 bg-[#FFFC00] border-4 border-black p-3 font-black text-black hover:translate-x-1 hover:translate-y-1 hover:shadow-none shadow-[4px_4px_0px_#000] transition-all"><i class="fa-brands fa-snapchat text-3xl"></i> <span class="text-xl">Snapchat</span></a>
                <a href="https://www.facebook.com/share/1A57dR6k74/" target="_blank" class="flex items-center gap-4 bg-[#1877F2] border-4 border-black p-3 font-black text-white hover:translate-x-1 hover:translate-y-1 hover:shadow-none shadow-[4px_4px_0px_#000] transition-all"><i class="fa-brands fa-facebook text-3xl"></i> <span class="text-xl">Facebook</span></a>
                <a href="https://x.com/misho_64" target="_blank" class="flex items-center gap-4 bg-black border-4 border-black p-3 font-black text-white hover:translate-x-1 hover:translate-y-1 hover:shadow-none shadow-[4px_4px_0px_#000] transition-all"><i class="fa-brands fa-x-twitter text-3xl"></i> <span class="text-xl">Twitter / X</span></a>
                <a href="https://t.me/misho_64" target="_blank" class="flex items-center gap-4 bg-[#0088cc] border-4 border-black p-3 font-black text-white hover:translate-x-1 hover:translate-y-1 hover:shadow-none shadow-[4px_4px_0px_#000] transition-all"><i class="fa-brands fa-telegram text-3xl"></i> <span class="text-xl">Telegram</span></a>
            </div>
        </div>
    </div>

    <div id="commentModal" class="fixed inset-0 bg-black/80 z-[100] hidden flex items-center justify-center p-4 backdrop-blur-sm">
        <div class="bg-white border-4 border-black shadow-hard p-6 w-full max-w-md relative">
            <button onclick="closeCommentModal()" class="absolute -top-4 -right-4 bg-red-500 text-white w-10 h-10 border-4 border-black font-black hover:scale-110">X</button>
            <h2 class="text-2xl font-black text-center mb-6 bg-brand-yellow border-2 border-black inline-block px-4 mx-auto -rotate-2">Ø§Ø®ØªØ± Ø´Ø®ØµÙŠØªÙƒ ğŸ‘¾</h2>
            <div id="step1">
                <div class="mb-4">
                    <label class="block font-bold mb-2">Ø§Ø³Ù…Ùƒ Ø§Ù„Ù…Ø³ØªØ¹Ø§Ø±:</label>
                    <input type="text" id="commentName" maxlength="11" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ (11 Ø­Ø±Ù)" class="w-full bg-gray-100 border-4 border-black p-2 font-bold outline-none focus:bg-brand-blue/20">
                </div>
                <label class="block font-bold mb-2">Ø§Ù„Ø´Ø®ØµÙŠØ© (Ø¨ÙƒØ³Ù„ Ø¢Ø±Øª):</label>
                <div class="grid grid-cols-3 gap-3 mb-6">
                    <label class="avatar-option cursor-pointer relative"><input type="radio" name="avatar" class="hidden" checked><div class="avatar-container"><svg class="pixel-svg" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><rect width="16" height="16" fill="#FF90E8"/><path d="M6 3H12V6H14V9H12V11H10V14H6V11H4V9H6V3Z" fill="#4ADE80"/><path d="M10 4H11V5H10V4Z" fill="black"/><path d="M10 7H13V8H10V7Z" fill="white"/><path d="M4 9H6V10H4V9Z" fill="#166534"/></svg></div></label>
                    <label class="avatar-option cursor-pointer relative"><input type="radio" name="avatar" class="hidden"><div class="avatar-container"><svg class="pixel-svg" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><rect width="16" height="16" fill="#22CCFF"/><path d="M4 3H6V6H10V3H12V6H13V10H12V13H4V10H3V6H4V3Z" fill="white"/><path d="M5 4H6V6H5V4Z" fill="#F472B6"/><path d="M10 4H11V6H10V4Z" fill="#F472B6"/><path d="M5 8H6V9H5V8Z" fill="black"/><path d="M10 8H11V9H10V8Z" fill="black"/><path d="M7 10H9V11H7V10Z" fill="#F472B6"/></svg></div></label>
                    <label class="avatar-option cursor-pointer relative"><input type="radio" name="avatar" class="hidden"><div class="avatar-container"><svg class="pixel-svg" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><rect width="16" height="16" fill="#FFDE00"/><path d="M3 3H6V6H10V3H13V6H14V10H12V13H4V10H2V6H3V3Z" fill="#F97316"/><path d="M6 10H10V13H6V10Z" fill="white"/><path d="M4 7H5V8H4V7Z" fill="black"/><path d="M11 7H12V8H11V7Z" fill="black"/><path d="M7 11H9V12H7V11Z" fill="black"/></svg></div></label>
                    <label class="avatar-option cursor-pointer relative"><input type="radio" name="avatar" class="hidden"><div class="avatar-container"><svg class="pixel-svg" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><rect width="16" height="16" fill="#FF90E8"/><path d="M2 3H6V6H10V3H14V6H13V11H11V13H5V11H3V6H2V3Z" fill="#9CA3AF"/><path d="M3 4H5V6H3V4Z" fill="#F472B6"/><path d="M11 4H13V6H11V4Z" fill="#F472B6"/><path d="M5 8H6V9H5V8Z" fill="black"/><path d="M10 8H11V9H10V8Z" fill="black"/><path d="M7 11H9V12H7V11Z" fill="black"/><path d="M4 9H2V10H4V9Z" fill="black"/><path d="M12 9H14V10H12V9Z" fill="black"/></svg></div></label>
                    <label class="avatar-option cursor-pointer relative"><input type="radio" name="avatar" class="hidden"><div class="avatar-container"><svg class="pixel-svg" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><rect width="16" height="16" fill="#9D4EDD"/><path d="M4 4H12V6H13V9H12V13H4V9H3V6H4V4Z" fill="#FCD34D"/><path d="M4 3H12V5H4V3Z" fill="black"/><path d="M3 5H4V9H3V5Z" fill="black"/><path d="M12 5H13V9H12V5Z" fill="black"/><path d="M5 7H11V9H5V7Z" fill="black"/></svg></div></label>
                    <label class="avatar-option cursor-pointer relative"><input type="radio" name="avatar" class="hidden"><div class="avatar-container"><svg class="pixel-svg" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><rect width="16" height="16" fill="#22CCFF"/><path d="M4 4H12V13H4V4Z" fill="#FCD34D"/><path d="M3 3H13V6H12V4H4V6H3V3Z" fill="#EC4899"/><path d="M2 6H4V13H2V6Z" fill="#EC4899"/><path d="M12 6H14V13H12V6Z" fill="#EC4899"/><path d="M5 7H6V9H5V7Z" fill="black"/><path d="M10 7H11V9H10V7Z" fill="black"/><path d="M7 11H9V12H7V11Z" fill="#EC4899"/></svg></div></label>
                </div>
                <button onclick="goToStep2()" class="btn-action w-full bg-brand-blue text-black border-4 border-black p-3 font-black shadow-hard hover:shadow-hard-hover hover:translate-y-1 transition-all">Ø§Ù„ØªØ§Ù„ÙŠ <i class="fa-solid fa-arrow-left mr-2"></i></button>
            </div>
            <div id="step2" class="hidden">
                 <div class="flex items-center gap-3 mb-4 p-3 bg-gray-100 border-4 border-black">
                    <div id="selectedAvatarPreview" class="w-12 h-12 border-2 border-black bg-white overflow-hidden"></div>
                    <span id="selectedNamePreview" class="font-black"></span>
                </div>
                <textarea id="commentText" rows="3" maxlength="20" placeholder="Ø§ÙƒØªØ¨ ØªØ¹Ù„ÙŠÙ‚Ùƒ (Ø£Ù‚ØµÙ‰ Ø­Ø¯ 20 Ø­Ø±Ù)..." class="w-full bg-gray-100 border-4 border-black p-2 font-bold outline-none focus:bg-brand-pink/20 mb-4 resize-none"></textarea>
                <div class="flex gap-2">
                    <button onclick="submitComment()" class="btn-action flex-1 bg-brand-yellow text-black border-4 border-black p-3 font-black shadow-hard hover:shadow-hard-hover hover:translate-y-1 transition-all">Ù†Ø´Ø± ğŸš€</button>
                    <button onclick="backToStep1()" class="btn-action bg-gray-200 text-black border-4 border-black p-3 font-black hover:bg-gray-300">Ø±Ø¬ÙˆØ¹</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Ø¯ÙˆØ§Ù„ Ø§Ù„Ù†ÙˆØ§ÙØ°
        function openContactModal() { document.getElementById('contactModal').classList.remove('hidden'); }
        function closeContactModal() { document.getElementById('contactModal').classList.add('hidden'); }
        function openCommentModal() { document.getElementById('commentModal').classList.remove('hidden'); backToStep1(); }
        function closeCommentModal() { document.getElementById('commentModal').classList.add('hidden'); }
        function backToStep1() { document.getElementById('step1').classList.remove('hidden'); document.getElementById('step2').classList.add('hidden'); }
        function closeWelcome() { document.getElementById('welcomeModal').classList.add('hidden'); }
        
        // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø£Ø¯Ù…Ù† (Ø¥Ù„ØºØ§Ø¡)
        function closeAdmin() { 
            document.getElementById('adminModal').classList.add('hidden'); 
            document.getElementById('adminLogin').classList.remove('hidden');
            document.getElementById('adminPanel').classList.add('hidden');
            document.getElementById('adminPass').value = '';
        }

        // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù„ÙˆØ­Ø© ÙÙ‚Ø· (Ù…Ø¹ Ø¥Ø¨Ù‚Ø§Ø¡ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª)
        function hideAdminPanel() {
            document.getElementById('adminModal').classList.add('hidden');
        }

        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ø§Ù„ÙƒØ§Ù…Ù„
        function logoutAdmin() {
            closeAdmin();
            document.body.classList.remove('admin-active');
            alert("ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ ğŸ”’");
        }

        function closeInfo() { document.getElementById('infoModal').classList.add('hidden'); }

        function showWorkInProgress(type) {
            const modal = document.getElementById('infoModal');
            const title = document.getElementById('infoTitle');
            const body = document.getElementById('infoBody');
            title.innerText = "Ù„Ø³Ù‡ Ø¨Ø¹Ù…Ù„ ØµÙØ­Ù‡ ğŸ˜‚";
            if (type === 'websites') {
                body.innerText = "ÙˆØµÙ Ù…ÙˆØ§Ù‚Ø¹ÙŠ ÙƒØ«ÙŠÙŠØ± Ø¨Ø³ Ù„Ø³Ù‡ Ø¨Ø¹Ù…Ù„ Ù…ÙƒØ§Ù† ÙŠØ¬Ù…Ø¹Ù‡Ù… ÙƒÙ„Ù‡Ù… ÙÙŠ Ù…ÙƒØ§Ù† ÙˆØ§Ø­Ø¯";
            } else {
                body.innerText = "ÙˆØµÙ ØªØµØ§Ù…ÙŠÙ…ÙŠ ÙƒØ«ÙŠÙŠØ± Ø¨Ø³ Ù„Ø³Ù‡ Ø¨Ø¹Ù…Ù„ Ù…ÙƒØ§Ù† ÙŠØ¬Ù…Ø¹Ù‡Ù… ÙƒÙ„Ù‡Ù… ÙÙŠ Ù…ÙƒØ§Ù† ÙˆØ§Ø­Ø¯";
            }
            modal.classList.remove('hidden');
        }

        // ==========================================
        //  âœ… Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø´Ø±ÙˆØ¹Ùƒ myweb-30e01 âœ…
        // ==========================================
        const firebaseConfig = {
            apiKey: "AIzaSyBO1bAxaOB6lho9hm8bUgQ2bCof5rb9QUw",
            authDomain: "myweb-30e01.firebaseapp.com",
            databaseURL: "https://myweb-30e01-default-rtdb.firebaseio.com",
            projectId: "myweb-30e01",
            storageBucket: "myweb-30e01.firebasestorage.app",
            messagingSenderId: "292448655689",
            appId: "1:292448655689:web:85192576c8446e5a2b6298",
            measurementId: "G-ZR3VM3LXHK"
        };

        let db;
        try {
            firebase.initializeApp(firebaseConfig);
            db = firebase.database();
            console.log("Firebase Connected âœ…");
        } catch(err) {
            console.error("Firebase Error:", err);
            document.querySelector('.loading-msg').innerHTML = "Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ âŒ<br>ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase!";
        }

        const clickSound = document.getElementById('clickSound');
        const popSound = document.getElementById('popSound');
        const msgSound = document.getElementById('msgSound');
        function playClick() { clickSound.currentTime = 0; clickSound.play(); }
        document.querySelectorAll('button, a').forEach(btn => btn.addEventListener('click', playClick));

        // Ø§Ù„Ù‡Ø§ÙŠØ¨
        const hypeBtn = document.getElementById('hypeBtn');
        const hypeCount = document.getElementById('hypeCount');
        let currentHype = localStorage.getItem('hypeLevel') ? parseInt(localStorage.getItem('hypeLevel')) : 1042;
        hypeCount.innerText = currentHype;
        hypeBtn.addEventListener('click', () => {
            currentHype++;
            hypeCount.innerText = currentHype;
            localStorage.setItem('hypeLevel', currentHype);
            popSound.currentTime = 0; popSound.play();
            hypeBtn.classList.add('hype-anim');
            setTimeout(() => hypeBtn.classList.remove('hype-anim'), 500);
            confetti({ particleCount: 80, spread: 60, origin: { x: 0.9, y: 0.9 }, angle: 135, colors: ['#FFDE00', '#FF90E8', '#22CCFF'] });
        });

        // ----------------------------------------------------
        // Ø§Ù„Ù…Ù†Ø·Ù‚ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
        // ----------------------------------------------------
        let siteSettings = {
            welcome: { enabled: true, text1: "Ø£Ù‡Ù„Ø§Ù‹ Ø¨ÙŠÙƒ ÙŠØ§ Ø­Ù„Ùˆ ğŸ‘‹", text2: "Ø£Ù†Øª Ø¬ÙŠØª ØªØ§Ù†ÙŠØŸ ğŸ˜’" },
            chat: { enabled: false },
            popup: { enabled: false, text: "Ø±Ø³Ø§Ù„Ø© Ù…Ù‡Ù…Ø©!", delay: 3 }
        };

        function getUserColor(id) {
            const colors = ['#FFDE00', '#FF90E8', '#9D4EDD', '#84cc16', '#f97316', '#06b6d4', '#f43f5e'];
            let hash = 0;
            for(let i=0; i<id.length; i++) hash += id.charCodeAt(i);
            return colors[hash % colors.length];
        }

        window.addEventListener('DOMContentLoaded', () => {
            if(db) {
                db.ref('site_settings').on('value', (snapshot) => {
                    const data = snapshot.val();
                    if(data) {
                        siteSettings = data;
                        updateAdminUI();
                        applyRealtimeSettings();
                    } else {
                        // Ù„Ùˆ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙØ§Ø¶ÙŠØ©
                        db.ref('site_settings').set(siteSettings);
                    }
                });

                setTimeout(() => {
                    handleWelcomeLogic();
                    handleGlobalPopup();
                }, 1000);

                const chatContainer = document.getElementById('chatMessages');
                db.ref('public_chat').limitToLast(50).on('child_added', (snapshot) => {
                    const msg = snapshot.val();
                    const key = snapshot.key;
                    const isMe = msg.senderID === localStorage.getItem('mo64_uid');
                    const div = document.createElement('div');
                    const color = getUserColor(msg.senderID);
                    div.className = `chat-bubble mb-2 max-w-[80%] break-words ${isMe ? 'chat-bubble-me' : 'chat-bubble-other'}`;
                    div.style.backgroundColor = isMe ? '#22CCFF' : color;
                    div.innerHTML = `${msg.text}<div class="msg-delete-btn" onclick="deleteSingleMessage('${key}', this)">X</div>`;
                    chatContainer.appendChild(div);
                    chatContainer.scrollTop = chatContainer.scrollHeight;
                    if(!isMe) msgSound.play().catch(()=>{});
                });

                db.ref('public_chat').on('child_removed', (snapshot) => {
                    const chatContainer = document.getElementById('chatMessages');
                    chatContainer.innerHTML = ''; 
                    db.ref('public_chat').limitToLast(50).once('value', (snap) => {
                        snap.forEach((child) => {
                            const msg = child.val();
                            const key = child.key;
                            const isMe = msg.senderID === localStorage.getItem('mo64_uid');
                            const div = document.createElement('div');
                            const color = getUserColor(msg.senderID);
                            div.className = `chat-bubble mb-2 max-w-[80%] break-words ${isMe ? 'chat-bubble-me' : 'chat-bubble-other'}`;
                            div.style.backgroundColor = isMe ? '#22CCFF' : color;
                            div.innerHTML = `${msg.text}<div class="msg-delete-btn" onclick="deleteSingleMessage('${key}', this)">X</div>`;
                            chatContainer.appendChild(div);
                        });
                        chatContainer.scrollTop = chatContainer.scrollHeight;
                    });
                });
                
                const commentsList = document.getElementById('commentsList');
                const commentsRef = db.ref('comments');
                commentsRef.on('value', (snapshot) => {
                    commentsList.innerHTML = '';
                    const data = snapshot.val();
                    if(data) {
                        const commentsArray = Object.entries(data).reverse();
                        commentsArray.forEach(([key, value]) => {
                            addCommentToDOM(key, value.name, value.text, value.avatar, value.likes || 0);
                        });
                    } else {
                        commentsList.innerHTML = '<div class="text-center text-gray-400 font-bold">ÙƒÙ† Ø§Ù„Ø£ÙˆÙ„ ÙÙŠ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚! ğŸš€</div>';
                    }
                });
            }
        });

        function handleWelcomeLogic() {
            if (!siteSettings.welcome?.enabled) return;
            let visitCount = localStorage.getItem('mo64_visit_count');
            if(!visitCount) visitCount = 0;

            if (visitCount == 0) {
                document.getElementById('welcomeTitle').innerText = siteSettings.welcome.text1 || "Ø£Ù‡Ù„Ø§Ù‹ Ø¨ÙŠÙƒ ÙŠØ§ Ø­Ù„Ùˆ ğŸ‘‹";
                document.getElementById('welcomeBody').innerHTML = "Ù†ÙˆØ±Øª Ù…ÙˆÙ‚Ø¹ÙŠ!<br>Ù…ØªÙ†Ø³Ø§Ø´ ØªØ¶ØºØ· Ø¹Ù„Ù‰ Ø¹Ù„Ø§Ù…Ø© Ø§Ù„Ù†Ø§Ø± (ğŸ”¥) ÙƒØ«ÙŠÙŠÙŠÙŠÙŠØ±!";
                localStorage.setItem('mo64_visit_count', 1);
                document.getElementById('welcomeModal').classList.remove('hidden');
                popSound.play();
            } else if (visitCount == 1) {
                document.getElementById('welcomeTitle').innerText = siteSettings.welcome.text2 || "Ø£Ù†Øª Ø¬ÙŠØª ØªØ§Ù†ÙŠØŸ ğŸ˜’";
                document.getElementById('welcomeBody').innerHTML = "Ù…Ù†ÙˆØ±Ù†ÙŠØŒ Ø£ÙƒÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¹Ø¬Ø¨Ùƒ ğŸ˜‰";
                localStorage.setItem('mo64_visit_count', 2);
                document.getElementById('welcomeModal').classList.remove('hidden');
                popSound.play();
            }
        }

        function handleGlobalPopup() {
            if (siteSettings.popup?.enabled && !sessionStorage.getItem('popupShown')) {
                const delay = (siteSettings.popup.delay || 3) * 1000;
                setTimeout(() => {
                    document.getElementById('globalMessageBody').innerText = siteSettings.popup.text;
                    document.getElementById('globalMessageModal').classList.remove('hidden');
                    sessionStorage.setItem('popupShown', 'true');
                    popSound.play();
                }, delay);
            }
        }

        function applyRealtimeSettings() {
            const fab = document.getElementById('chatFab');
            if (siteSettings.chat?.enabled) {
                fab.classList.remove('hidden');
            } else {
                fab.classList.add('hidden');
                document.getElementById('globalChatModal').classList.add('hidden');
            }
        }

        function updateAdminUI() {
            updateToggleBtn('toggleWelcomeBtn', siteSettings.welcome?.enabled);
            updateToggleBtn('toggleChatBtn', siteSettings.chat?.enabled);
            updateToggleBtn('togglePopupBtn', siteSettings.popup?.enabled);

            if(document.getElementById('adminPanel').classList.contains('hidden')) return;
            
            document.getElementById('welcomeText1').value = siteSettings.welcome?.text1 || "";
            document.getElementById('welcomeText2').value = siteSettings.welcome?.text2 || "";
            document.getElementById('popupText').value = siteSettings.popup?.text || "";
            document.getElementById('popupDelay').value = siteSettings.popup?.delay || 3;
        }

        function updateToggleBtn(btnId, state) {
            const btn = document.getElementById(btnId);
            if(btn) {
                btn.innerText = state ? "Ù…ÙØ¹Ù„ âœ…" : "Ù…Ø¹Ø·Ù„ âŒ";
                btn.className = state ? "text-xs px-2 py-1 bg-green-500 text-white font-bold border-2 border-black" : "text-xs px-2 py-1 bg-red-500 text-white font-bold border-2 border-black";
                btn.dataset.state = state;
            }
        }

        function toggleSetting(type) {
            if(!db) return alert("Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± Ù…ØªØµÙ„Ø©!");
            let path = '';
            let currentValue = false;
            if (type === 'welcome') { path = 'welcome/enabled'; currentValue = siteSettings.welcome?.enabled; }
            else if (type === 'chat') { path = 'chat/enabled'; currentValue = siteSettings.chat?.enabled; }
            else if (type === 'popup') { path = 'popup/enabled'; currentValue = siteSettings.popup?.enabled; }
            db.ref('site_settings/' + path).set(!currentValue).catch(err => alert("Ø­Ø¯Ø« Ø®Ø·Ø£: " + err));
        }

        function saveWelcomeTexts() {
            const t1 = document.getElementById('welcomeText1').value;
            const t2 = document.getElementById('welcomeText2').value;
            db.ref('site_settings/welcome/text1').set(t1);
            db.ref('site_settings/welcome/text2').set(t2);
            alert("ØªÙ… Ø­ÙØ¸ Ù†ØµÙˆØµ Ø§Ù„ØªØ±Ø­ÙŠØ¨ ğŸ‘");
        }

        function savePopupSettings() {
            const text = document.getElementById('popupText').value;
            const delay = document.getElementById('popupDelay').value;
            db.ref('site_settings/popup/text').set(text);
            db.ref('site_settings/popup/delay').set(parseInt(delay));
            alert("ØªÙ… Ù†Ø´Ø± Ø§Ù„Ø±Ø³Ø§Ù„Ø© (Ø³ØªØ¸Ù‡Ø± Ù„Ù„Ø²ÙˆØ§Ø± Ø§Ù„Ø¬Ø¯Ø¯) ğŸ“¢");
        }

        function deleteAllChat() {
            if(confirm("âš ï¸ Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ØŸ Ø³ÙŠØªÙ… Ø­Ø°Ù ÙƒÙ„ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© ÙˆÙ„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹!")) {
                db.ref('public_chat').remove()
                .then(() => alert("ØªÙ… ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø´Ø§Øª Ø¨Ù†Ø¬Ø§Ø­ ğŸ§¼"))
                .catch(err => alert("Ø®Ø·Ø£: " + err));
            }
        }

        function deleteSingleMessage(key, btnElement) {
            if(confirm("Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø±Ø³Ø§Ù„Ø©ØŸ")) {
                db.ref('public_chat/' + key).remove();
                btnElement.parentElement.remove();
            }
        }

        // ===============================================
        //  TRIGGER LOGIC: 3 Clicks on "Guestbook Title"
        // ===============================================
        let clickCount = 0; 
        let clickTimer;
        document.getElementById('guestbookTitle').addEventListener('click', () => {
            clickCount++;
            if (clickCount === 1) clickTimer = setTimeout(() => { clickCount = 0; }, 1000);
            if (clickCount === 3) { 
                clearTimeout(clickTimer); 
                clickCount = 0; 
                document.getElementById('adminModal').classList.remove('hidden'); 
            }
        });

        // Also keep the name trigger as a backup or allow access if already logged in
        document.getElementById('adminTriggerBtn').addEventListener('click', () => {
            // If already active, show panel directly
            if(document.body.classList.contains('admin-active')) {
                document.getElementById('adminModal').classList.remove('hidden');
                document.getElementById('adminLogin').classList.add('hidden');
                document.getElementById('adminPanel').classList.remove('hidden');
            } else {
                document.getElementById('adminModal').classList.remove('hidden');
            }
        });

        function checkAdmin() {
            if (document.getElementById('adminPass').value === "meme2003") {
                document.body.classList.add('admin-active'); 
                document.getElementById('adminLogin').classList.add('hidden');
                document.getElementById('adminPanel').classList.remove('hidden');
                updateAdminUI(); 
                alert("Ø£Ù‡Ù„Ø§Ù‹ ÙŠØ§ Ù…Ø¯ÙŠØ±! ğŸ•µï¸â€â™‚ï¸");
            } else { alert("ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± ØºÙ„Ø·! ğŸ˜‚"); }
        }

        // -------------------------
        // ÙƒÙˆØ¯ Ø§Ù„Ø´Ø§Øª (Draggable)
        // -------------------------
        const fab = document.getElementById('chatFab');
        let isDragging = false, startX, startY, initialLeft, initialTop;

        fab.addEventListener('mousedown', startDrag);
        fab.addEventListener('touchstart', startDrag, {passive: false});

        function startDrag(e) {
            isDragging = false;
            if(e.type === 'touchstart') { startX = e.touches[0].clientX; startY = e.touches[0].clientY; } 
            else { startX = e.clientX; startY = e.clientY; }
            const rect = fab.getBoundingClientRect();
            initialLeft = rect.left; initialTop = rect.top;
            fab.style.bottom = 'auto'; fab.style.right = 'auto';
            fab.style.left = initialLeft + 'px'; fab.style.top = initialTop + 'px';
            fab.style.transition = 'none';
            document.addEventListener('mousemove', drag); document.addEventListener('touchmove', drag, {passive: false});
            document.addEventListener('mouseup', endDrag); document.addEventListener('touchend', endDrag);
        }
        function drag(e) {
            let clientX, clientY;
            if(e.type === 'touchmove') { clientX = e.touches[0].clientX; clientY = e.touches[0].clientY; } 
            else { clientX = e.clientX; clientY = e.clientY; }
            if (Math.abs(clientX - startX) > 5 || Math.abs(clientY - startY) > 5) {
                isDragging = true;
                e.preventDefault(); 
            }
            fab.style.left = (initialLeft + clientX - startX) + 'px';
            fab.style.top = (initialTop + clientY - startY) + 'px';
        }
        function endDrag() {
            document.removeEventListener('mousemove', drag); document.removeEventListener('touchmove', drag);
            document.removeEventListener('mouseup', endDrag); document.removeEventListener('touchend', endDrag);
            fab.style.transition = 'all 0.3s ease-out';
            const rect = fab.getBoundingClientRect();
            if (rect.left + rect.width / 2 < window.innerWidth / 2) fab.style.left = '20px';
            else fab.style.left = (window.innerWidth - rect.width - 20) + 'px';
            if(rect.top < 20) fab.style.top = '20px';
            if(rect.bottom > window.innerHeight - 20) fab.style.top = (window.innerHeight - rect.height - 20) + 'px';
            setTimeout(() => { isDragging = false; }, 100);
        }

        function toggleGlobalChat() {
            if (isDragging) return;
            const modal = document.getElementById('globalChatModal');
            const container = document.getElementById('chatContainer');
            if (modal.classList.contains('hidden')) {
                modal.classList.remove('hidden');
                setTimeout(() => container.classList.remove('translate-y-full'), 10);
            } else {
                container.classList.add('translate-y-full');
                setTimeout(() => modal.classList.add('hidden'), 300);
            }
        }

        function sendGlobalMessage() {
            const input = document.getElementById('globalChatInput');
            const text = input.value.trim();
            if (!text) return;
            let uid = localStorage.getItem('mo64_uid');
            if (!uid) { uid = 'user_' + Math.random().toString(36).substr(2, 9); localStorage.setItem('mo64_uid', uid); }
            db.ref('public_chat').push({ text: text, senderID: uid, timestamp: Date.now() });
            input.value = '';
        }

        // -------------------------
        // ÙƒÙˆØ¯ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª ÙˆØ§Ù„Ù‚Ù„ÙˆØ¨
        // -------------------------
        function getRandomHeartSVG() {
            const colors = ['#FF0099', '#FFDE00', '#22CCFF', '#9D4EDD', '#000000', '#FF0000', '#00FF00', '#FF5733'];
            const c1 = colors[Math.floor(Math.random() * colors.length)];
            const c2 = colors[Math.floor(Math.random() * colors.length)];
            const c3 = colors[Math.floor(Math.random() * colors.length)];
            const type = Math.floor(Math.random() * 5);
            let svgContent = '';
            if (type === 0) svgContent = `<path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" fill="${c1}" stroke="black" stroke-width="1.5"/><path d="M6 10 L8 8 L10 10 L12 8 L14 10 L16 8 L18 10" stroke="${c2}" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"/><circle cx="12" cy="14" r="2.5" fill="${c3}" stroke="black" stroke-width="1"/>`;
            else if (type === 1) svgContent = `<path d="M7 4h2v2h2v-2h2v2h2v2h2v2h-2v2h-2v2h-2v2h-2v-2h-2v-2h-2v-2h2v-2z" fill="${c1}" stroke="black" stroke-width="1"/><rect x="9" y="7" width="2" height="2" fill="${c2}"/><rect x="13" y="7" width="2" height="2" fill="${c2}"/>`;
            else if (type === 2) svgContent = `<path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" fill="${c1}" stroke="black" stroke-width="1.5"/><path d="M4 9h16M6 13h12M9 17h6" stroke="${c2}" stroke-width="2"/>`;
            else if (type === 3) svgContent = `<path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" fill="${c1}" stroke="black" stroke-width="1.5"/><path d="M12 17l-1-1C8 13 6 11 6 9c0-1.5 1-2.5 2.5-2.5 1 0 2 .5 2.5 1.5.5-1 1.5-1.5 2.5-1.5 1.5 0 2.5 1 2.5 2.5 0 2-2 4-5 7l-1 1z" fill="${c2}" stroke="black"/>`;
            else svgContent = `<defs><linearGradient id="g${Math.random()}" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" style="stop-color:${c1};stop-opacity:1" /><stop offset="100%" style="stop-color:${c2};stop-opacity:1" /></linearGradient></defs><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" fill="url(#g${Math.random()})" stroke="black" stroke-width="1.5"/>`;
            return `<svg viewBox="0 0 24 24" class="w-8 h-8 hover:scale-110 transition-transform cursor-pointer heart-svg-btn">${svgContent}</svg>`;
        }

        function addCommentToDOM(key, name, text, avatarSVG, likes) {
            const safeName = name.replace(/</g, "&lt;").replace(/>/g, "&gt;");
            const safeText = text.replace(/</g, "&lt;").replace(/>/g, "&gt;");
            const heartSVG = getRandomHeartSVG();
            // Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… Ù…Ø¶Ø§ÙØ© Ù‡Ù†Ø§ Ù„ÙƒÙ†Ù‡Ø§ Ù…Ø®ÙÙŠØ© Ø¹Ø¨Ø± CSS
            const html = `
                <div class="comment-item flex gap-3 bg-white border-4 border-black p-3 shadow-[2px_2px_0px_#000] relative group" data-key="${key}">
                    <div class="comment-admin-btns">
                        <button onclick="editComment('${key}', '${safeName}', '${safeText}', ${likes})" class="bg-blue-500 text-white w-6 h-6 border-2 border-black text-xs hover:scale-110 flex items-center justify-center rounded-full"><i class="fa-solid fa-pen"></i></button>
                        <button onclick="deleteComment('${key}')" class="bg-red-500 text-white w-6 h-6 border-2 border-black text-xs hover:scale-110 flex items-center justify-center rounded-full"><i class="fa-solid fa-trash"></i></button>
                    </div>
                    
                    <div class="w-12 h-12 border-2 border-black bg-white overflow-hidden shrink-0">${avatarSVG}</div>
                    <div class="flex-1">
                        <h4 class="comment-name font-black text-sm">${safeName}</h4>
                        <p class="comment-text text-sm font-bold text-gray-600 break-words">${safeText}</p>
                    </div>
                    <div class="flex flex-col items-center justify-center gap-1 ml-2">
                        <div onclick="likeComment('${key}')">${heartSVG}</div>
                        <span class="text-xs font-black">${likes}</span>
                    </div>
                </div>`;
            commentsList.insertAdjacentHTML('beforeend', html);
        }

        function likeComment(key) {
            const btn = document.querySelector(`div[data-key="${key}"] .heart-svg-btn`);
            if(btn) { btn.classList.remove('like-bounce'); void btn.offsetWidth; btn.classList.add('like-bounce'); }
            db.ref('comments/' + key + '/likes').transaction((currentLikes) => (currentLikes || 0) + 1);
            popSound.currentTime = 0; popSound.play();
        }

        function goToStep2() {
            if (!nameInput.value.trim()) { alert("Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ Ø§Ù„Ø£ÙˆÙ„!"); return; }
            document.getElementById('selectedAvatarPreview').innerHTML = document.querySelector('input[name="avatar"]:checked').nextElementSibling.querySelector('svg').outerHTML;
            document.getElementById('selectedNamePreview').innerText = nameInput.value;
            document.getElementById('step1').classList.add('hidden');
            document.getElementById('step2').classList.remove('hidden');
        }

        function submitComment() {
            if (!commentInput.value.trim()) { alert("Ø§ÙƒØªØ¨ Ø£ÙŠ Ø­Ø§Ø¬Ø©!"); return; }
            db.ref('comments').push({ name: nameInput.value, text: commentInput.value, avatar: document.getElementById('selectedAvatarPreview').innerHTML, likes: 0, timestamp: Date.now() });
            commentInput.value = ''; closeCommentModal(); popSound.play();
        }

        function deleteComment(key) { if(confirm("Ø­Ø°Ù Ù†Ù‡Ø§Ø¦ÙŠØŸ")) db.ref('comments/' + key).remove(); }
        
        // Ø¯Ø§Ù„Ø© Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ (Ø§Ù„Ø§Ø³Ù…ØŒ Ø§Ù„Ù†ØµØŒ Ø§Ù„Ù„Ø§ÙŠÙƒØ§Øª)
        function editComment(key, oldName, oldText, oldLikes) {
            const newName = prompt("ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø§Ø³Ù…:", oldName);
            if(newName !== null) {
                const newText = prompt("ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù†Øµ:", oldText);
                if(newText !== null) {
                    const newLikes = prompt("ØªØ¹Ø¯ÙŠÙ„ Ø¹Ø¯Ø¯ Ø§Ù„Ù„Ø§ÙŠÙƒØ§Øª:", oldLikes);
                    if (newLikes !== null) {
                        db.ref('comments/' + key).update({
                            name: newName,
                            text: newText,
                            likes: parseInt(newLikes) || 0
                        });
                    }
                }
            }
        }
    </script>
</body>
</html>
